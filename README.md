
# Анализ DoS-атак в IoT-трафике

Этот Jupyter-ноутбук демонстрирует полный процесс построения модели для выявления атак типа DoS в сетевом трафике IoT-устройств. Включены этапы подготовки данных, обучения модели, анализа признаков и генерации контрфактических примеров.
Ссылка на [Датасет](https://www.kaggle.com/datasets/subhajournal/iotintrusion/data).

В рамках данной работы были реализованы:

1. Классификатор на основе случайного леса, для детектирования DoS атак;
2. Проанализированы SHAP-значения признаков;
3. На основе соответствующих значения был создангенератор синтетических объектов для данного классификатора;
4. В рамках альтернативного решения был создан жадный генератор с учетом наиболее важных признаков;
5. В дополнении был создан генератор синтетических объектов на основе успешно измененных в рамках работы жадного генератора объектов;
6. Проведено краткое сравнение с наиболее важными признаками согласно SHAP-значениям ряда других атак.

## Структура проекта

- Загрузка и предварительный анализ датасета `IoT_Intrusion.csv`
- Преобразование меток: `label` → `DoS` / `не DoS`
- Масштабирование признаков (`MinMaxScaler`)
- Обучение модели: `RandomForestClassifier`
- Интерпретация модели с помощью SHAP
- Генерация контрфактов:
  - `static_generator` — фиксированные минимальные изменения
  - `greedy_generator` — адаптивный жадный поиск
- Генерация синтетических примеров:
  - на основе успешных контрфактов
  - по SHAP-топ признакам
- Визуализация важности признаков и анализ чувствительности модели

## Быстрый старт

1. Установите зависимости:

```bash
pip install -r requirements.txt
```

2. Убедитесь, что в папке проекта лежит файл `IoT_Intrusion.csv`.

3. Запустите ноутбук в Jupyter Notebook или JupyterLab.

## requirements.txt

```text
pandas>=1.3.0
numpy>=1.21.0
shap>=0.41.0
matplotlib>=3.4.0
seaborn>=0.11.0
scikit-learn>=1.0.0
```

## Ключевые функции

| Функция                         | Назначение |
|----------------------------------|------------|
| `research_label(df, name)`       | Обучение модели и SHAP-анализ признаков |
| `shap_research(...)`             | Построение bar-графика SHAP важности |
| `static_generator(...)`          | Простая генерация с фиксированными шагами |
| `greedy_generator(...)`          | Жадная генерация с подбором оптимального изменения |
| `generate_synthetic_samples(...)`| Синтетика на основе успешных контрфактов |
| `generate_synthetic_from_shap(...)` | Синтетика по SHAP-признакам |

## Визуализации

- SHAP bar-графики важнейших признаков
- Сравнение оригинальных и контрфактических примеров
